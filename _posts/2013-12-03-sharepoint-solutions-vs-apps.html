---
layout: post
title: SharePoint Solutions vs Apps
date: '2013-12-03T10:00:00.000+04:00'
author: "Станислав Выщепан"
tags:
- SharePoint 2013
- sp2013
- apps
- SharePoint
modified_time: '2013-12-03T17:34:00.667+04:00'
blogger_id: tag:blogger.com,1999:blog-1302241583051203640.post-4884667871386216715
blogger_orig_url: http://blog.gandjustas.ru/2013/12/sharepoint-solutions-vs-apps.html
redirect_from: /2013/12/sharepoint-solutions-vs-apps.html
category: SharePoint 2013
---

<p>Если вы еще не в курсе что такое apps (приложения), то прочтите <a href="http://gandjustas.blogspot.com/2013/12/sharepoint-apps-intro.html" target="_blank">предыдущий пост</a>.</p> <p>На этот рас попробуем разобраться когда надо использовать <em>приложения</em>, а когда стоит делать <em>решения</em>. </p> <p><em>Приложения</em> и <em>решения</em> не пересекаются вообще. Для <em>приложений</em> важна изоляция, чтобы приложение не повиляло на ферму и не делало то, чего делать нельзя. Для <em>решений</em> важна интеграция с платформой. <em>Решения</em> могут использовать возможности SharePoint, дополнять и улучшать их.</p>  <p>Microsoft предлагает всем делать <em>приложения</em>, в соответствии с cloud-first политикой. Считается что если сделать <em>приложение</em>, то оно заработает в Office 365 и onprem. Но именно в этом заключается первое заблуждение относительно <em>приложений</em>.</p> <h4>Первое заблуждение</h4> <p>Люди думают что onprem <em>приложения</em> также хорошо работают, как в облаке. На самом деле<em> приложения</em>, сделанные для Office 365 сложно использовать onprem.</p> <p>Во-первых provider-hosted app просто так не заработают onprem, потому что onprem не работает OAuth. Можно настроить интеграцию onprem с Office 365, но это порядка на два сложнее и затратнее, чем сделать приложение. </p> <p>Во-вторых можно настроить Server-to-Server Trust (S2S), но для такого <em>приложения</em> потребуется изменение исходного кода, деплой во внутренней сети, powershell скрипт для установки, который требует farm admin привилегий. </p> <p>В-третьих – поддержка apps в onpremise варианте требует тщательной настройки&nbsp; - приложения службы, DNS, сертификаты. Особенно часто возникают проблемы если надо выставить ферму с apps в интернет.</p> <p>Единственный тип <em>приложений</em>, которые можно поставить из маркета, без дополнительных телодвижений – SharePoint-hosted. Но и тут есть проблемы...</p> <h4>Второе заблуждение</h4> <p>Люди считают что <em>SharePoint-hosted app </em>удобно использовать чтобы задействовать возможности SharePoint. На самом это возможно в очень ограниченных сценариях.</p> <p>Напомню что SharePoint-hosted app – это артефакты SharePoint и JavaScript, размещаемые на отдельном сайте (AppWeb). Подробнее тут - <a title="http://www.instantquick.com/index.php/sharepoint-2013-app-web-versus-host-web-redux?c=elumenotion-blog-archive/sharepoint-2013-and-office-365-apps" href="http://www.instantquick.com/index.php/sharepoint-2013-app-web-versus-host-web-redux?c=elumenotion-blog-archive/sharepoint-2013-and-office-365-apps">http://www.instantquick.com/index.php/sharepoint-2013-app-web-versus-host-web-redux?c=elumenotion-blog-archive/sharepoint-2013-and-office-365-apps</a>.</p> <p>Проблемы:</p> <ul> <li>AppWeb в onprem не работает если у вас не-windows аутентификация (<a title="http://blah.winsmarts.com/2013-6-SharePoint_hosted_apps,_are_terrible.aspx" href="http://blah.winsmarts.com/2013-6-SharePoint_hosted_apps,_are_terrible.aspx">http://blah.winsmarts.com/2013-6-SharePoint_hosted_apps,_are_terrible.aspx</a>).</li> <li>SharePoint-hosted app не поддерживают app-only policy (повышение привилегий).</li> <li>UI для AppWeb ограничен по сравнению с Host Web: <a title="http://www.instantquick.com/index.php/host-web-versus-app-web-case-study-clients" href="http://www.instantquick.com/index.php/host-web-versus-app-web-case-study-clients">http://www.instantquick.com/index.php/host-web-versus-app-web-case-study-clients</a>.</li> <li>Развертывание артефактов на Host Web требует минимум Manage разрешений, а для полного использования возможностей SharePoint понадобится full control.</li></ul> <h4>Третье заблуждение</h4> <p>Люди считают что авторизация <em>приложений</em> (разрешения) поможет сделать эти <em>приложения</em> более безопасными. На самом деле разрешения зачастую работают против разработчиков и не способствуют повышению безопасности.</p> <p>Во-первых для некоторых действий требуется слишком много разрешений. Например запись в социальную ленту требует прав записи в весь Тенант (в Office365) или во всю ферму (в onprem).&nbsp; Такой высокий уровень разрешений позволяет делать <em>приложению</em> что угодно с вашими данными. </p> <p>Во-вторых, чтобы установить <em>приложение</em>, пользователь его устанавливающий должен обладать правами, которое требует <em>приложение</em>. Например поставить <em>приложение</em>, требующее прав на тенант (даже только чтение), сможет только админ фермы.</p> <p>В-третьих в маркет не принимают <em>приложения</em>, требующие full control. То есть серьезное <em>приложение</em>, использующее потенциал SharePoint, поставить из маркета невозможно.</p> <h3>Выводы</h3> <ol> <li>SharePoint-hosted <em>приложения</em> подходят только для небольшого изолированного функционала. Например информеров погоды\пробок и (не дай бог) дней рождения.</li> <li>Provider-hosted в onprem имеет смысл только для интеграции существующего <em>приложения</em> в SharePoint. Создавать новое слишком накладно.</li> <li>В office 365 имеет смысл делать provider-hosted (с хостингом в Auzre Websites). Но мало что удастся получить <em>приложению</em> от SharePoint. Поэтому скорее будет вариант построить веб-приложение, а потом интегрировать с SharePoint. Примерно так работает новый LightSwitch.</li></ol> <p>Вкратце <em>приложения </em>имеет смысл делать или для чего-то простого, или для интеграции отдельных веб-приложений в SharePoint. А для всего остального...</p> <h3>Используйте Sandboxed Solution</h3> <p>Если вы начали возмущаться, говорить что Microsoft запретил Sandbox, то будете правы, почти. Microsoft запретил <em>серверный код</em> в Sandboxed решениях. И то “запретил” – громко сказано, сейчас он работает как в облаке, так и onprem.</p> <p>Но вы можете в вашем решении разворачивать JavaScript код, типы контента, списки, страницы, шаблоны сайтов, workflow (в 2013 они декларативные), схему поиска и прочие радости. При этом также сохраняя стабильность фермы, даже если вы запускаете серверный код. Хотя потребность в серверном коде в SharePoint 2013 гораздо меньше.</p> <p>Все новые возможности SharePoint 2013 (CSOM\REST, Client-Side Rendering) доступны для <em>решений</em>, также как для <em>приложений</em>. При этом для установки достаточно быть sitecollection администратором. Пока еще работает серверный код в Sandbox, вы можете легко делать Event Receiver.</p> <p>В Sandbox <em>решении</em> вы легко можете повторить архитектуру <em>приложений</em>, предоставляя пользователям не набор фич, а шаблон сайта, с преднастроенным набором фич.</p> <p>Когда возможностей sandbox не хватит для реализации функционала вы можете сделать FullTrust <em>решение</em>, которые выставляет User Code Proxy и веб-части, а ваше Sandbox <em>решение</em> их использует. А в Office365, в случае нехватки возможностей Sandbox, можно в iframe показывать внешний сайт и делать Remote Event Receivers.</p> <h3>Заключение</h3> <p>По странному стечению обстоятельств новые возможности SharePoint вдохнули жизнь в концепцию, которую Microsoft пытался похоронить. Sandboxed <em>решения</em> свободны от недостатков SharePoint-hosted <em>приложений</em>, при этом гораздо проще, чем provider-hosted. Именно с них стоит начинать разработку для SharePoint, кроме самых простых случаев.</p> <p>Кстати маркет можно использовать для привлечения клиентов, сделав прототип\демо вашего приложения в SharePoint-hosted варианте, и предлагая установить sandboxed ршение уже вне маркета.</p>  
