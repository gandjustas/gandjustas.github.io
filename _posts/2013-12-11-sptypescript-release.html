---
layout: post
title: SPTypeScript Release 1.3
date: '2013-12-11T10:00:00.000+04:00'
author: "Станислав Выщепан"
tags:
- SharePoint 2013
- sp2013
- javascript
- typescript
- SharePoint
modified_time: '2013-12-11T15:09:52.671+04:00'
thumbnail: http://lh6.ggpht.com/--_5lPOub5N8/UqY8P1vcO8I/AAAAAAAAAZw/tkKYAbwZvC8/s72-c/image_thumb%25255B2%25255D.png?imgmax=800
blogger_id: tag:blogger.com,1999:blog-1302241583051203640.post-9084679056315069855
blogger_orig_url: http://blog.gandjustas.ru/2013/12/sptypescript-release.html
redirect_from: /2013/12/sptypescript-release.html
category: SharePoint Client Side
---

<p><a href="http://www.typescriptlang.org/" target="_blank">TypeScript</a> неумолимо приближается к релизу, недавно вышла версия 0.9.5.</p> <p>Вместе с этим мы продолжаем развивать наши определения типов JavaScript Object Model в SharePoint, чтобы вам было комфортно писать клиентский код для решений и приложений SharePoint.</p> <p>На сайте проекта <a title="http://sptypescript.codeplex.com/" href="http://sptypescript.codeplex.com/">http://sptypescript.codeplex.com/</a> опубликован новый релиз, в который вошли:</p> <ul> <li>Определения для Chrome Control для apps.  <li>Определения для SPClientPeoplePicker для создания кастомных форм с контролом выбора людей.  <li>Полные определения типов для пространств имен SP.Publishing и SP.DocumentManagement из файлов sp.publishing.js и sp.documentManagement.js соответственно. Они вам очень пригодятся для ECM\WCM сценариев.  <li>Reputation object model – для социальных приложений.  <li>Множество примеров и мелкие улучшения существующих определений.</li></ul> <p>Ссылка на релиз - <a title="http://sptypescript.codeplex.com/releases/view/115896" href="http://sptypescript.codeplex.com/releases/view/115896">http://sptypescript.codeplex.com/releases/view/115896</a></p> <p>Также последнюю версию определений можно получить с помощью NuGet -<a title="http://www.nuget.org/packages/sharepoint.TypeScript.DefinitelyTyped/" href="http://www.nuget.org/packages/sharepoint.TypeScript.DefinitelyTyped/">http://www.nuget.org/packages/sharepoint.TypeScript.DefinitelyTyped/</a></p> <h3>Как использовать TypeScript для приложений SharePoint</h3> <p>Для начала установите <a href="http://go.microsoft.com/fwlink/?LinkID=266563" target="_blank">последнюю версию TypeScript</a> (0.9.5).</p> <p>Создаете новый App для SharePoint в VisualStudio 2013</p> <p><a href="http://lh3.ggpht.com/-moLziLFLvUo/UqY8O1MJK5I/AAAAAAAAAZo/pcqGMHBU5N0/s1600-h/image%25255B4%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh6.ggpht.com/--_5lPOub5N8/UqY8P1vcO8I/AAAAAAAAAZw/tkKYAbwZvC8/image_thumb%25255B2%25255D.png?imgmax=800" width="560" height="335"></a></p> <p>Теперь самое неприятное – надо поправить .csproj файл, чтобы включить компиляцию TypeScript. Для этого надо:</p> <ul> <li>В контекстном меню проекта нажать Unload Project  <li>На выгруженном проекте нажать Edit  <li>В самом конце, перед закрывающим тегом Project надо добавить одну строчку:  <blockquote> <p>&lt;Import Project="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v$(VisualStudioVersion)\TypeScript\Microsoft.TypeScript.targets" /&gt;</p></blockquote> <li>На выгруженном проекте нажать Reload Project  <li>Верить что к релизу не придется исполнять эти танцы с бубном...</li></ul> <p>После этого надо выставить настройки проекта в свойствах проекта<br><a href="http://lh5.ggpht.com/-HLVjmM8bC4I/UqY8QmXgsxI/AAAAAAAAAZ0/C4qyPaaFAMs/s1600-h/image%25255B29%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; margin: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-WiPDltHzz58/UqY8RDuiNjI/AAAAAAAAAZ8/BdKtaCQeg_c/image_thumb%25255B25%25255D.png?imgmax=800" width="560" height="216"></a></p> <p>Далее переименовываете App.js в _App.js. Удалять не надо, он еще пригодится.</p> <p><a href="http://lh3.ggpht.com/-W4VNlNpwXAk/UqY8RntidtI/AAAAAAAAAaE/6v41ukrCVlc/s1600-h/image%25255B10%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-AnNfN7I8kEc/UqY8SYdbnKI/AAAAAAAAAaQ/ezZuSgB3DVI/image_thumb%25255B11%25255D.png?imgmax=800" width="449" height="480"></a></p> <p>Добавляете App.ts файл</p> <p><a href="http://lh5.ggpht.com/-VD9YQ2FOA3I/UqY8S3zz3oI/AAAAAAAAAaU/2F9FOlkSqt8/s1600-h/image%25255B15%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh5.ggpht.com/-JXDAAR6S0KA/UqY8TRLdNnI/AAAAAAAAAag/T0utOBhjD8k/image_thumb%25255B14%25255D.png?imgmax=800" width="560" height="387"></a></p> <p>Добавляете дефинишены для SharePoint и JQuery с помощью NuGet</p> <p><a href="http://lh4.ggpht.com/-hp3bhl6jpyw/UqY8UAtFRiI/AAAAAAAAAao/4Zz_pegwN0c/s1600-h/image%25255B20%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-1Uu6aCuMORM/UqY8U0wQLpI/AAAAAAAAAaw/xuB7tAUQ6RM/image_thumb%25255B17%25255D.png?imgmax=800" width="560" height="373"></a></p> <p>Копируете содержимое _App.js в App.ts и удаляете _App.js и сразу получаете типизацию в .ts файле. Можно также сделать небольшой рефакторинг в стандартном шаблоне, чтобы максимально использовать типизацию:</p> <p><a href="http://lh4.ggpht.com/-yAGNRoZmcVc/UqY8V53OAAI/AAAAAAAAAa4/f69SBwkJdow/s1600-h/image%25255B35%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh6.ggpht.com/-AFjhdqeU0yc/UqY8WmvBhEI/AAAAAAAAAbA/en8msgSJ-y0/image_thumb%25255B37%25255D.png?imgmax=800" width="560" height="227"></a></p> <p>Последний штрих – скомпилировать проект и добавить сгенерированные App.js и App.js.map в решение.</p> <p><a href="http://lh6.ggpht.com/-TBmy-IdQp-o/UqY8XB4zocI/AAAAAAAAAbE/QQBd1y_5cgk/s1600-h/image%25255B48%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh4.ggpht.com/-dJrMM5PPvUU/UqY8XtvTgMI/AAAAAAAAAbQ/HM1gbFavB9Y/image_thumb%25255B51%25255D.png?imgmax=800" width="560" height="397"></a></p> <p>Теперь можно запускать приложение и будет работать отладка в .ts файле</p> <p><a href="http://lh5.ggpht.com/-cZFkS5uyqE8/UqY8YWgpweI/AAAAAAAAAbY/JpTqOemc3A8/s1600-h/image%25255B53%25255D.png"><img title="image" style="border-left-width: 0px; border-right-width: 0px; background-image: none; border-bottom-width: 0px; padding-top: 0px; padding-left: 0px; display: inline; padding-right: 0px; border-top-width: 0px" border="0" alt="image" src="http://lh3.ggpht.com/-G0EvDSta7rI/UqY8ZFkMPqI/AAAAAAAAAbg/5qwEaJmpcyA/image_thumb%25255B54%25255D.png?imgmax=800" width="560" height="437"></a></p> <h3>Планы на будущее</h3> <p>Сейчас дефинишенами покрыто почти все API для которого можно хоть как-то найти документацию. К релизу TypeScript 1.0 мы выпустим версию SPTypeScript 1.5 (или 2.0). Если есть какой-то API SharePoint, для которого вы хотите видеть дефинишены в нашем проекте, пишите на CodePlex в раздел Discussions - <a title="http://sptypescript.codeplex.com/discussions" href="http://sptypescript.codeplex.com/discussions">http://sptypescript.codeplex.com/discussions</a>.</p> <p>Будем рады любому фидбеку.</p>  
