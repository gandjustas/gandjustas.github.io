---
layout: post
title: "Конфигурация Unity"
date: '2009-01-22T13:14:00.001+03:00'
author: "Станислав Выщепан"
tags:
- Unity
- ".NET"
- IoC-контейнер
modified_time: '2009-01-22T13:14:32.752+03:00'
blogger_id: tag:blogger.com,1999:blog-1302241583051203640.post-5818286199791224912
blogger_orig_url: http://blog.gandjustas.ru/2009/01/unity_8026.html
redirect_from: /2009/01/unity_8026.html
category: IOC
---

<p>Существует четыре различных способа конфигурирования контейнера.</p>  <p>1)Использование соглашений. Фактически отсутствие явного конфигурирования. В Unity используется очень простое соглашение, что в классе должен быть один конструктор, который принимает все зависимости параметрами.    <br />Такой способ подходит для 90% случаев если вы пишите код сами.</p>  <p>2)Указание зависимостей с помощью атрибутов. Для свойств есть DependencyAttribute, для конструктора указывается InjectionConstructorAttribute, для метода InjectionMethodAttribute. Для параметров конструктора и injection-методов также можно указывать DependencyAttribute.    <br />При навешивании DependencyAttribute на свойство или параметр можно указать имя зависимости.</p>  <p>3)Задание конфигурации в коде при добавлении элемента в контейнер.    <br />Последним параметром метода RegisterType является массив InjectionMember. В этом массиве можно передать объекты типа InjectionProperty, InjectionConstructor и InjectionMethod чтобы указать с помощью каких членов класса проводить инъекцию.     <br />При указании InjectionConstructor и InjectionMethod для каждого параметра можно указать конкретное значение или попросить контейнер резолвить нужный параметр.     <br />Такой способ дает гораздо более многословен, чем все остальные способы, но дает гораздо большую гибкость. С помощью конфигурации в коде можно использовать IoC с классами, к исходникам которых нет доступа.</p>  <p>4)Задание конфигурации в XML.&#160; Этот способ имеет смысл применять только если нужно изменять конфигурацию без&#160; перекомпиляции&#160; программы. Конфигурация в XML не позволяет описывать произвольные типы, поэтому обладает меньшей мощностью по сравнению с конфигурацией в коде.</p>  <p>Подробнее о возможностях конфигурирования Unity можно почитать по ссылкам    <br /><a title="http://msdn.microsoft.com/en-us/library/dd203225.aspx" href="http://msdn.microsoft.com/en-us/library/dd203225.aspx">http://msdn.microsoft.com/en-us/library/dd203225.aspx</a>     <br /><a title="http://msdn.microsoft.com/en-us/library/dd203208.aspx" href="http://msdn.microsoft.com/en-us/library/dd203208.aspx">http://msdn.microsoft.com/en-us/library/dd203208.aspx</a>     <br /><a title="http://msdn.microsoft.com/en-us/library/dd203195.aspx" href="http://msdn.microsoft.com/en-us/library/dd203195.aspx">http://msdn.microsoft.com/en-us/library/dd203195.aspx</a>     <br /><a title="http://msdn.microsoft.com/en-us/library/dd203156.aspx" href="http://msdn.microsoft.com/en-us/library/dd203156.aspx">http://msdn.microsoft.com/en-us/library/dd203156.aspx</a>     <br /><a title="http://msdn.microsoft.com/en-us/library/dd203230.aspx" href="http://msdn.microsoft.com/en-us/library/dd203230.aspx">http://msdn.microsoft.com/en-us/library/dd203230.aspx</a>     <br />    <br /></p>  <h4>Overconfiguration или Темная сторона силы</h4>  <p>Часто программисты, познакомившись с IoC-контейнерами и оценив их возможности декларативного конфигурирования, начинают использовать конфигурацию по любому поводу. Это приводит к тому что конфиги становятся монструозных размеров и абсолютно нечитаемые. При этом по коду программы абсолютно невозможно понять какой код когда выполняется. Любые изменения затрагивают не только код, но и конфигурацию, что может привести к проблемам при развертывании.</p>  <p>Поэтому при использовании любой технологии, которая может очень сильно конфигурироваться, предпочитайте пользоваться соглашениями (Convetions over Configuration) и размещайте конфигурацию как можно ближе к месту использования. Для этого используйте атрибуты и помещайте код конфигурирования в ту же сборку, где находятся конфигурируемые классы.</p>  
