---
layout: post
title: "Миф о кастомизации страниц в SharePoint"
date: '2012-01-31T10:00:00.000+04:00'
author: "Станислав Выщепан"
tags:
- SharePoint
modified_time: '2012-01-31T10:00:02.890+04:00'
blogger_id: tag:blogger.com,1999:blog-1302241583051203640.post-5182434830410150215
blogger_orig_url: http://blog.gandjustas.ru/2012/01/sharepoint.html
redirect_from: /2012/01/sharepoint.html
category: SharePoint
---

<p>Немного теории. В SharePoint есть <em>виртуальная файловая система</em>, которая содержится в контентной БД. Когда вы в farm solution помещаете в нее файл, с помощью модуля, то файл лежит на диске в {SharePointRoot}\TEMPLATE\Features, а контентной БД появляется ссылка на этот файл.</p>  <p>Таким образом экономится место в БД, ведь один и тот же файл может быть добавлен на несколько сайтов. Кроме того упрощается обновление – достаточно обновить файл на диске. </p>  <p>Такие файлы называются <em>uncustomized</em>, <em>ghosted</em> (в терминологии 2007 шарика) или просто <em>некастомизироваными</em>. Если же попробовать внести какое-либо изменение в файл <strong>в виртуальной файловой системе (!)</strong>, то измененное состояние файла записывается в контентную БД и SharePoint перестает обращаться к диску за файлом. такие файлы называются <em>customized</em>, <em>unghosted</em> или <em>кастомизированные</em>. </p>  <p>Причем это относится не только к файлам в виртуальной ФС, но и к типам контента, шаблонам списков итд. Но об этом другой раз…</p>  <h4>Миф</h4>  <blockquote>   <p>Кастомизированные страницы работают медленнее некастомизированных.</p> </blockquote>  <p>В сети довольно много рассуждений на эту тему, что для кастомизированных страниц не работают какие-то механизмы кеширования, требуется перекомпиляция каждый раз итд.</p>  <p>Я решил просто померить как изменяется скорость работы SharePoint от кастомизации страниц. Сделал простой веб-тест в Visual Studio, который обращается к странице по-умолчанию, а потом создал нагрузочный тест и замерял <strong>Page Response Time</strong>.</p>  <p>Вот график (кликабельно):</p>  <p><a href="https://public.blu.livefilestore.com/y1p_8XFGKM9Hoe3olDx_FjGwg097SgZdhWwcNccWt3UeoLHkSfrvLLxpUJs4yMlb_Zc76MOHfi4Vf8SxfnejLyNzA/customized%20page%20performance.png?psid=1" target="_blank"><img src="https://public.blu.livefilestore.com/y1p_8XFGKM9Hoe3olDx_FjGwg097SgZdhWwcNccWt3UeoLHkSfrvLLxpUJs4yMlb_Zc76MOHfi4Vf8SxfnejLyNzA/customized%20page%20performance.png?psid=1" width="517" height="281" /></a></p>  <p>Центральный пик - сохранение кастомизированной страницы, слева - время ответда для некастомизированной старницы, справа - время ответа кастомизированной страницы. Среднее время ответа некастомизированной страницы – 1.7 сек, кастомизироанной – 1.9 сек. Разница около 10%. Если на странице будут “тяжелые” контролы, то разница станет еще менее заметной.</p>  <p>При кастомизации мастер страницы график еще интереснее:</p>  <p><a href="https://public.blu.livefilestore.com/y1pJ-CsVyCXXE2xXm1JH_IOcQKDGxiVKQcRLJgOUUDtKF6zo1OrEbTz5prFTzORejYq4lYlo3chgyfWgHNSNy06sw/customized%20masterpage%20performance.png?psid=1" target="_blank"><img src="https://public.blu.livefilestore.com/y1pJ-CsVyCXXE2xXm1JH_IOcQKDGxiVKQcRLJgOUUDtKF6zo1OrEbTz5prFTzORejYq4lYlo3chgyfWgHNSNy06sw/customized%20masterpage%20performance.png?psid=1" width="544" height="288" /></a></p>    <p>Большой пик – кастомизация мастер-страницы. Справа пик поменьше – было сделано Revert To Definition для мастер-страницы. Получается результаты почти одинаковые, за исключением того, что для некастомизированного masterpage результаты гораздо менее стабильны.</p>  <h4>Заключение</h4>  <p>Использовать исключительно некастомизированные страницы имеет смысл только для hiload публичных сайтов. Хотя кто использует sharepoint для hiload сценариев???….</p>  
