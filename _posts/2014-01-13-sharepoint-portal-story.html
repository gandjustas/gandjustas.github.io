---
layout: post
title: "Как обычно делают корпоративный портал на SharePoint"
date: '2014-01-13T10:00:00.000+04:00'
author: "Станислав Выщепан"
tags:
- "портал"
- SharePoint
modified_time: '2014-01-13T10:00:07.891+04:00'
blogger_id: tag:blogger.com,1999:blog-1302241583051203640.post-217129547001828942
blogger_orig_url: http://blog.gandjustas.ru/2014/01/sharepoint-portal-story.html
---

<p>Недавно на facebook был опубликован (не мной) просто эпичный пост про корпоративный портал на SharePoint. Поиска по постам на facebook нет, поэтому приведу содержание здесь:</p> <blockquote> <p>...а в конце декабря мы решили-таки натянуть новый дизайн на наш корпоративный портал. В итоге, отработав все предпоследние выхи года, получив, таким образом, поистине бесконечную 12-дневную рабочую неделю, дизайн мы-таки натянули и даже выловили все крупные и критичные баги, а не критичные оставили на новый год.<br></p> <p>В итоге, в крайнюю пятницу старого года, взяв 30е и 31е декабря в счёт отработанных выхов, иду в бар, пью пиво и вообще всячески начинаю радоваться наступившим наконец каникулам. Но радость моя длилась ровно 2 дня, пока не закончились выходные. </p> <p>В понедельник меня будит звонок руководителя, который сообщает, что портал не работает. При чем весь и полностью. До этого у нас были проблемы с главной страницей, но мы их успешно решили. А тут умерло вообще все. Ни один сайт не открывается. Исследования показали, что серваки просто не справляются с нагрузкой: очередь в IIS как при СССР за докторской колбасой, а памяти она жрет больше обычного раза в три. Кое-как продравшись в layouts, меняю мастер-страницу на дефолтную и наследую её для всех узлов. Портал моментально взлетает. Почти. Весь, кроме главной страницы. Выяснилось, что на главной странице masterpage жестко прописан в коде. Так как подрядчиков было уже не достать, оставил всё как есть и почти счастливо пошел отмечать новый год.</p> <p>Сегодня танцы с бубном продолжили уже подрядчики. Код их, деньги уже уплочены, так что пусть свои косяки и исправляют. И что в итоге? А всё очень просто. В masterpage оказалась вшита веб-часть, которая подгружала курсы валют с сайта cbr.ru, но подгружала она не на серверной стороне, а на клиентской без какого-либо кеширования. В итоге, админы cbr получив с одного IP 100 000+ запросов за менее чем рабочий день, банально нас забанили. Веб-часть же начала ругаться на отсутствие аутентификации. А так как написана она была левой пяткой, то ругалась до бесконечности, не позволяя подгрузить о стальной контент страницы. Баг, который может проявиться только при опытной эксплуатации и на тестах его выявить практически нереально.</p></blockquote> <p>Автор поста – админ, не программист, но хорошо разбирается в SharePoint. Поэтому оставим технические детали вроде серверной\клиентской стороны для веб части (судя по симптомам загрузка курсов была именно на сервере).</p> <p>Первоначально все накинулись на подрядчиков с рекомендациями писать try\catch. Но ошибка, вероятнее всего, была вызвана как раз использованием try с пустым catch (без throw) в цикле. Ошибка довольно типичная для среднестатистического разработчика SharePoint. Но самое важное в этой истории как раз то, что не написано и не касается подрядчиков вообще.</p> <p>Какая необходимость вообще возникла пихать информер курсов валют на все страницы всех сайтов портала? От этого есть реальный value? Даже в финансовых организациях от силы 30% сотрудников будут получать преимущество от такого функционала, но у них, скорее всего, будет специальный софт, где будут и курсы валют и многое другое. А в среднестатистической организации курсы валют на каждой странице не нужны никому, а если вдруг кому-то понадобятся, то они быстрее зайдут на сам cbr.ru.</p> <p>Коммент на тему откуда вообще появились курсы валют:</p> <blockquote> <p>Курсы валют все равно есть и в 1С и на всяких яндексах и т.д. Но партия (руководство) сказала надо, значит надо.</p></blockquote> <p>Это прекрасно! Полтора года назад у меня уже был <a href="http://gandjustas.blogspot.com/2012/06/sharepoint.html" target="_blank">пост на тему создания решений</a>, где тоже все свелось к мифическому “руководству”. Значит и подходы, описанные&nbsp; в моем посте, остаются такими же верными.</p> <p>Также очевидна проблема с управлением проектом. Это надо быть очень везучим, чтобы накатывать большое обновление за несколько дней до нового года и ничего не сломалось. Но оказывается все еще интереснее:</p> <blockquote> <p>...но проект должен был быть завершен в августе, а так как все сроки подрядчики просрали их заставили до НГ все закончить.</p></blockquote> <p>То есть кто-то посчитал что подрядчики, которые уже зафейлили один срок и работают в режиме аврала, сделают решение, которое не упадет на продакшене? И при этом не было никакого контроля качества? И при этом решили ставить обновление перед новым годом, а потом сразу идти в отпуска, думали что все будет хорошо?</p> <p>Ну и корень всей этой ситуации:</p> <blockquote> <p>скажу просто, что данных подрядчиков выбирали по красивой картинке, кто лучше нарисовал, тот и выиграл. Над Business-value никто особо не заморачивался. По большому счёту этот редизайн вообще никому из простых юзеров не нужен был. </p></blockquote> <p>Без комментариев...</p> <h4>Резюме</h4> <p>Вот так обычно делают порталы на SharePoint:</p> <ol> <li>Выбирают по красивой картинке (проблема <em>заказчика</em>).  <li>Не работают с требованиями (проблема <em>заказчика</em>).  <li>Полное отсутствие менеджмента проекта на стороне заказчика (понятно чья проблема).  <li>Полное отсутствие контроля качества на стороне заказчика (аналогично) .  <li>Подрядчики не обладают достаточной квалификацией по созданию порталов (по сути единственная проблема <em>подрядчиков</em>).  <li>У <em>заказчика</em> вообще нет стратегии внедрения и развития портала.</li></ol> <p>При этом все ругаются именно на подрядчиков. Хотя даже с плохими подрядчиками можно делать хорошие проекты, при нормальном менеджменте у заказчика.</p> <p>Если же нет специалистов у заказчика, то обязательно нужно нанимать консультантов ДО начала проекта. Это позволит сэкономить гораздо больше денег.</p>  