---
layout: post
title: SharePoint Apps Intro
date: '2013-12-02T11:00:00.000+04:00'
author: "Станислав Выщепан"
tags:
- SharePoint 2013
- sp2013
- apps
- SharePoint
modified_time: '2013-12-02T11:00:24.066+04:00'
blogger_id: tag:blogger.com,1999:blog-1302241583051203640.post-4674127412994599711
blogger_orig_url: http://blog.gandjustas.ru/2013/12/sharepoint-apps-intro.html
redirect_from: /2013/12/sharepoint-apps-intro.html
category: SharePoint 2013
---

<p>С момента релиза SharePoint 2013 прошел ровно год. Я специально не писал ничего про Apps, собирал информацию и анализировал опыт.</p> <h3>Что такое Apps</h3> <p>Краткий дисклеймер для тех, кто не в курсе что такое Apps. Идея apps заключается в том, что пользователи смогут самостоятельно устанавливать приложения для SharePoint из Market или внутреннего каталога компании. Примерно также, как это происходит на мобильных устройствах. Но, в отличии от мобильных устройств, любой посторонний код для SharePoint очень опасен. Поэтому нужно этот код максимально изолировать, ограничить в правах и жестко контролировать.</p> <p>Кажется мы то уже слышали в 2010 году, и тогда это были Sandbox Solutions? Именно! Мотивация такая же, как и раньше – увеличить стабильность фермы и дать больше возможности устанавливать решения пользователям.</p> <p>Но Microsoft решил пойти шире и сказал что apps вообще не должны работать на серверах SharePoint. Это может быть JavaScript в браузере, или внешний веб-сервис, общающийся с SharePoint с помощью клиентской объектной модели. </p> <p>Так как код становится внешним, по отношению к SharePoint, то там можно использовать любые языки и библиотеки. Angular или Backbone на клиенте, ASP.NET MVC+EF или даже PHP+MySQL на сервере.</p> <h3>Архитектура Apps</h3> <blockquote> <p>Здесь и далее я буду называть <em>apps</em> - <em><strong>приложениями</strong></em>, а <em>solutions</em> – <em><strong>решениями</strong></em>.</p></blockquote> <p>Приложения ставятся на сайт (SPWeb) из того же интерфейса, из кодоторого создаются списки. Более того, теперь списки тоже называются приложениями, но это не более чем маркетинговый ход.</p> <p>Технически приложения для SharePoint представляют манифест, который описывает как можно обратиться к App. Способов на самом деле немного:</p> <ul> <li>Переход по ссылке на сайт приложения, это обязательно для любого приложения.  <li>Отображение в iframe на странице SharePoint, примерно как веб-часть в решении.  <li>Переход по ссылке или отображение в iframe в виде диалога из Ribbon или меню, примерно как custom action в решении.</li></ul> <p>Еще можно привязать внешний event receiver, но это уже нужно делать в коде приложения.</p> <p>А теперь главный вопрос: где же будет работать приложение?</p> <p>Тут два варианта:</p> <ul> <li>Внешний, по отношению к SharePoint, веб-сервер. Его разработчик должен самостоятельно развернуть, настроить SSL, обеспечить доступность, изоляцию между экземплярами приложений, и прочие радости. Это называется Provider-hosted app. Есть еще вариант автоматического развертывания сайта в Azure из пакета приложения (AutoHosted), но он, спустя год после релиза, толком не работает в Office 365, а onprem скорее всего никогда не будет.  <li>Подсайт в SharePoint. Для экземпляра приложения может быть создан отдельный сайт (appweb). На сайт можно разворачивать обычные артефакты SharePoint – страницы, файлы, списки, workflows. Серверный код нельзя деплоить, поэтому доступен только код на JavaScript. AppWeb автоматически удаляется при удалении приложения. Это называется SharePoint-hosted.</li></ul> <p>Эти два варианта не взаимоисключающие. Вы можете иметь отдельный сервер, где будет работать код на любимом вами языке, при этом приложение будет создавать AppWeb и писать данные туда. Или наоборот, код у вас будет на JavaScript в AppWeb и будет обращаться к веб-сервисам на внешнем сайте. </p> <h3>Маркет и монетизация приложений</h3> <p>Главная завлекаловка для разработчиков – возможность монетизировать приложения. Приложение может быть плантым и иметь разные варианты лицензирования. Платные приложения можно распространять только через маркет, при этом приложения проверяются людьми до попадания в маркет и требуется соблюдение правил (<a href="http://msdn.microsoft.com/en-us/library/office/jj220035.aspx" target="_blank">правила</a>).</p> <p>Маркет очень удобен для пользователей, они могут сами находить и ставить приложения. Не требуется качать файлы, запускать скрипты и делать другие непонятные вещи.</p> <h3>Что может делать приложение</h3> <p>Потенциально почти все. Клиентская объектная модель покрывает очень много возможностей – работа с артефактами SharePoint (сайтами, списками, элементами), поиск, таксономия, профили пользователей, публикация, социальные возможности, BCS и даже Project Server.</p> <p>При этом для приложений назначаются разрешения, которые запрашиваются при установке. Для вычисления эффективных разрешений права пользователя и разрешения приложения пересекаются. Если приложение имеет доступ на запись, а пользователь может только читать, то записать что-либо не получится.</p> <p>Еще есть app-only policy, когда права пользователя не учитываются, учитываются только разрешения приложения. Это как повышение привилегий, которого так не хватало в Sandbox. Но, увы, не работает в JavaScript коде.</p> <h3>Стоит ли использовать apps?</h3> <p>Спустя год вполне можно оценить насколько apps получили распространение, достаточно заглянть в маркет: <a title="http://office.microsoft.com/en-us/store/results.aspx?avg=osu150" href="http://office.microsoft.com/en-us/store/results.aspx?avg=osu150">http://office.microsoft.com/en-us/store/results.aspx?avg=osu150</a>. Приложений не просто мало, а очень мало. Немалая часть из них – не живые. Также можно найти аналитику по использованию приложений -&nbsp; <a title="http://www.instantquick.com/index.php/one-month-since-release-observations-lessons-learned-and-future-plans" href="http://www.instantquick.com/index.php/one-month-since-release-observations-lessons-learned-and-future-plans"> http://www.instantquick.com/index.php/one-month-since-release-observations-lessons-learned-and-future-plans</a>.</p> <p>Среди моих знакомых мало кто пишет apps, несмотря на то что половина новых проектов стартует на SharePoint 2013.</p> <p>Есть мнение что apps вообще не приносят ничего полезного для разработчиков: <a title="http://blog.furuknap.net/sharepoint-2013-app-model-solves-non-problems-only" href="http://blog.furuknap.net/sharepoint-2013-app-model-solves-non-problems-only">http://blog.furuknap.net/sharepoint-2013-app-model-solves-non-problems-only</a>.</p> <p>Все это составляет грустную картину про приложения. В следующий раз постараюсь проанализировать недостатки apps и дать развернутый ответ для чего стоит использовать приложения и решения SharePoint...</p>  
